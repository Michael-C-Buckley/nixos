watch_file flake.lock

if [ -n "$IN_NIX_SHELL" ]; then
  echo "direnv: already inside Nix shell, skipping flake activation."
  exit
fi

export DIRENV_LOG_FORMAT="direnv: %s"
export DIRENV_QUIET=1

if [ "${DIRENV_QUIET:-0}" = 1 ]; then
  eval "$(use flake --accept-flake-config . 2>/dev/null)" >/dev/null
else
  use flake --accept-flake-config .
fi

if [ -d .git ]; then
  git status --short --branch
fi